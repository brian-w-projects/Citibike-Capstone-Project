mice::complete(imputed.data, 1)
imputed.data <- mice::mice(to.impute, m=5, maxit=10, seed=123, printFlag=FALSE)
completed.data <- cbind(ph, mice::complete(imputed.data, 1))
View(completed.data)
completed.data %>%
VIM::aggr(col=c('navyblue', 'yellow'),
numbers=TRUE, sortVars=TRUE,
labels=names(raw.data), cex.axis=.7,
gap=3, ylab=c('Missing Data', 'Pattern'), combined=TRUE
)
View(completed.data)
completed.data %>%
filter(!complete.cases(.))
completed.data %>%
VIM::aggr(col=c('navyblue', 'yellow'),
numbers=TRUE, sortVars=TRUE,
labels=names(completed.data), cex.axis=.7,
gap=3, ylab=c('Missing Data', 'Pattern'), combined=TRUE
)
completed.data <- completed.data %>%
filter(complete.cases(.))
completed.data %>%
VIM::aggr(col=c('navyblue', 'yellow'),
numbers=TRUE, sortVars=TRUE,
labels=names(completed.data), cex.axis=.7,
gap=3, ylab=c('Missing Data', 'Pattern'), combined=TRUE
)
completed.data %>%
write_csv('data.csv')
View(completed.data)
completed.data %>%
ggplot(aes(ph)) +
geom_histogram()
completed.data %>%
ggplot(aes(ph)) +
geom_histogram(bins=40)
completed.data %>%
ggplot(aes(ph)) +
geom_histogram(bins=50)
completed.data %>%
ggplot(aes(ph)) +
geom_histogram(bins=30)
View(completed.data)
completed.data %>%
corrplot::corrplot()
completed.data %>%
corr() %>%
corrplot::corrplot()
completed.data %>%
cor() %>%
corrplot::corrplot(method='circle')
completed.data %>%
select(-brandcode) %>%
cor() %>%
corrplot::corrplot(method='circle')
library(tidyverse)
#library(tigris)
library(leaflet)
#library(sp)
#library(ggmap)
#library(maptools)
#library(broom)
#library(httr)
#library(rgdal)
key <- 'AIzaSyC_p8GZTwYgrRgMibQU8rhM-LXS8KFKGIM'
register_google(key= key)
core1 <- read_csv('core1.csv')
nyc_map <- get_map(location = c(lon = -74.00, lat = 40.71), maptype = "terrain", zoom = 11)
nyc_map %>%
leaflet() %>%
addMarkers(~lon, ~lat, data=core1) %>%
addProviderTiles("CartoDB.Positron")
core2 <- read_csv('core2.csv')
nyc_map %>%
leaflet() %>%
addMarkers(~lon, ~lat, data=core2) %>%
addProviderTiles("CartoDB.Positron")
library(tidyverse)
library(tigris)
library(leaflet)
library(ggmap)
register_google(key= key)
nyc_map <- get_map(location = c(lon = -74.00, lat = 40.71), maptype = "terrain", zoom = 11)
display.plot <- function(file, threshold=50){
csv <- read_csv(file) %>%
filter(row_number() <= threshold)
nyc_map %>%
leaflet() %>%
addMarkers(~lon, ~lat, data=csv) %>%
addProviderTiles("CartoDB.Positron")
}
r <- GET('http://data.beta.nyc//dataset/0ff93d2d-90ba-457c-9f7e-39e47bf2ac5f/resource/35dd04fb-81b3-479b-a074-a27a37888ce7/download/d085e2f8d0b54d4590b1e7d1f35594c1pediacitiesnycneighborhoods.geojson')
library(httr)
r <- GET('http://data.beta.nyc//dataset/0ff93d2d-90ba-457c-9f7e-39e47bf2ac5f/resource/35dd04fb-81b3-479b-a074-a27a37888ce7/download/d085e2f8d0b54d4590b1e7d1f35594c1pediacitiesnycneighborhoods.geojson')
nyc_neighborhoods <- readOGR(content(r,'text'), 'OGRGeoJSON', verbose = F)
library(rgdal)
r <- GET('http://data.beta.nyc//dataset/0ff93d2d-90ba-457c-9f7e-39e47bf2ac5f/resource/35dd04fb-81b3-479b-a074-a27a37888ce7/download/d085e2f8d0b54d4590b1e7d1f35594c1pediacitiesnycneighborhoods.geojson')
nyc_neighborhoods <- readOGR(content(r,'text'), 'OGRGeoJSON', verbose = F)
nyc_neighborhoods_df <- tidy(nyc_neighborhoods)
??tidy
library(broom)
nyc_neighborhoods_df <- tidy(nyc_neighborhoods)
nyc_map %>%
ggmap() +
geom_polygon(data=nyc_neighborhoods_df, aes(x=long, y=lat, group=group))
nyc_map %>%
ggmap() +
geom_polygon(data=nyc_neighborhoods_df, aes(x=long, y=lat, group=group), color='blue', fill=NA)
nyc_neighborhoods %>%
leaflet() +
addTiles() %>%
addPolygons() %>%
addProviderTiles("CartoDB.Positron")
nyc_neighborhoods %>%
leaflet() +
addTiles() %>%
addPolygons(~long, ~lat) %>%
addProviderTiles("CartoDB.Positron")
nyc_neighborhoods %>%
leaflet() +
addTiles() %>%
addPolygons(popup=~neighborhood) %>%
addProviderTiles("CartoDB.Positron")
nyc_neighborhoods <- readOGR(content(r,'text'), 'OGRGeoJSON', verbose = F)
summary(nyc_neighborhoods)
View(nyc_neighborhoods_df)
View(nyc_neighborhoods)
nyc_map %>%
leaflet() +
addTiles() %>%
addPolygons(~long, ~lat, data=nyc_neighborhoods) %>%
addProviderTiles("CartoDB.Positron")
nyc_map %>%
leaflet() %>%
addTiles() %>%
addPolygons(~long, ~lat, data=nyc_neighborhoods) %>%
addProviderTiles("CartoDB.Positron")
nyc_neighborhoods %>%
leaflet() %>%
addTiles() %>%
addPolygons() %>%
addProviderTiles("CartoDB.Positron")
setwd("D:/GradClasses/Spring19/698/citibike-dashboard/graph/output")
data <- read_csv('core1.csv') %>%
filter(now_number() <= 20)
data <- read_csv('core1.csv') %>%
filter(row_number() <= 20)
data
View(data)
points_spdf <- points
coordinates(points_spdf) <- ~lng + lat
library(sp)
coordinates(points_spdf) <- ~lng + lat
View(data)
coordinates(points_spdf) <- ~lon + lat
proj4string(points_spdf) <- proj4string(nyc_neighborhoods)
`coordinates<-`(points_spdf, ~lng + lat)
`coordinates(points_spdf)<-`(~lon + lat)
?coordinates
sp::coordinates(points_spdf) <- ~lon + lat
points_spdf <- data
sp::coordinates(points_spdf) <- ~lon + lat
proj4string(points_spdf) <- proj4string(nyc_neighborhoods)
matches <- over(points_spdf, nyc_neighborhoods)
data <- cbind(data, matches)
View(data)
data <- read_csv('circle.csv')
points_spdf <- data
coordinates(points_spdf) <- ~lon + lat
proj4string(points_spdf) <- proj4string(nyc_neighborhoods)
matches <- over(points_spdf, nyc_neighborhoods)
data <- cbind(data, matches)
View(data)
c <- data %>%
group_by(neighborhood) %>%
count()
View(c)
map_data <- geo_join(nyc_neighborhoods, c, 'neighborhood', 'neighborhood')
pal <- colorNumeric(palette='RdBu', domain=range(map_data@data$n, na.rm=T))
nyc_neighborhoods %>%
leaflet() %>%
addTiles() %>%
addPolygons() %>%
addProviderTiles("CartoDB.Positron")
map_data %>%
leaflet() %>%
addTiles() %>%
addPolygons() %>%
addProviderTiles("CartoDB.Positron")
map_data %>%
leaflet() %>%
addTiles() %>%
addPolygons(fillColor= ~pal(n)) %>%
addProviderTiles("CartoDB.Positron")
?addPolygons
map_data %>%
leaflet() %>%
addTiles() %>%
addPolygons(fillColor= ~pal(n), opacity=0) %>%
addProviderTiles("CartoDB.Positron")
data <- read_csv('high_ratio.csv')
points_spdf <- data
coordinates(points_spdf) <- ~lon + lat
proj4string(points_spdf) <- proj4string(nyc_neighborhoods)
matches <- over(points_spdf, nyc_neighborhoods)
data <- cbind(data, matches)
c <- data %>%
group_by(neighborhood) %>%
count()
map_data <- geo_join(nyc_neighborhoods, c, 'neighborhood', 'neighborhood')
pal <- colorNumeric(palette='RdBu', domain=range(map_data@data$n, na.rm=T))
map_data %>%
leaflet() %>%
addTiles() %>%
addPolygons(fillColor= ~pal(n), opacity=0) %>%
addProviderTiles("CartoDB.Positron")
c <- data %>%
group_by(neighborhood) %>%
summarize(n = mean(ratio))
map_data <- geo_join(nyc_neighborhoods, c, 'neighborhood', 'neighborhood')
pal <- colorNumeric(palette='RdBu', domain=range(map_data@data$n, na.rm=T))
map_data %>%
leaflet() %>%
addTiles() %>%
addPolygons(fillColor= ~pal(n), opacity=0) %>%
addProviderTiles("CartoDB.Positron")
View(c)
data <- read_csv('pagerank.csv')
points_spdf <- data
data <- read_csv('page.csv')
points_spdf <- data
coordinates(points_spdf) <- ~lon + lat
proj4string(points_spdf) <- proj4string(nyc_neighborhoods)
matches <- over(points_spdf, nyc_neighborhoods)
data <- cbind(data, matches)
c <- data %>%
group_by(neighborhood) %>%
summarize(n = mean(ratio))
map_data <- geo_join(nyc_neighborhoods, c, 'neighborhood', 'neighborhood')
pal <- colorNumeric(palette='RdBu', domain=range(map_data@data$n, na.rm=T))
map_data %>%
leaflet() %>%
addTiles() %>%
addPolygons(fillColor= ~pal(n), opacity=0) %>%
addProviderTiles("CartoDB.Positron")
c <- data %>%
group_by(neighborhood) %>%
summarize(n = mean(pagerank))
map_data <- geo_join(nyc_neighborhoods, c, 'neighborhood', 'neighborhood')
pal <- colorNumeric(palette='RdBu', domain=range(map_data@data$n, na.rm=T))
map_data %>%
leaflet() %>%
addTiles() %>%
addPolygons(fillColor= ~pal(n), opacity=0) %>%
addProviderTiles("CartoDB.Positron")
?addPolygons
map_data %>%
leaflet() %>%
addTiles() %>%
addPolygons(fillColor= ~pal(n), opacity=0.1, weight=1) %>%
addProviderTiles("CartoDB.Positron")
c <- data %>%
filter(row_number() <= 100) %>%
group_by(neighborhood) %>%
count()
map_data <- geo_join(nyc_neighborhoods, c, 'neighborhood', 'neighborhood')
pal <- colorNumeric(palette='RdBu', domain=range(map_data@data$n, na.rm=T))
map_data %>%
leaflet() %>%
addTiles() %>%
addPolygons(fillColor= ~pal(n), opacity=0.1, weight=1) %>%
addProviderTiles("CartoDB.Positron")
data <- read_csv('circle.csv')
points_spdf <- data
coordinates(points_spdf) <- ~lon + lat
proj4string(points_spdf) <- proj4string(nyc_neighborhoods)
matches <- over(points_spdf, nyc_neighborhoods)
data <- cbind(data, matches)
c <- data %>%
filter(row_number() <= 100) %>%
group_by(neighborhood) %>%
count()
map_data <- geo_join(nyc_neighborhoods, c, 'neighborhood', 'neighborhood')
pal <- colorNumeric(palette='RdBu', domain=range(map_data@data$n, na.rm=T))
map_data %>%
leaflet() %>%
addTiles() %>%
addPolygons(fillColor= ~pal(n), opacity=0.1, weight=1) %>%
addProviderTiles("CartoDB.Positron")
data <- read_csv('core1.csv')
points_spdf <- data
coordinates(points_spdf) <- ~lon + lat
proj4string(points_spdf) <- proj4string(nyc_neighborhoods)
matches <- over(points_spdf, nyc_neighborhoods)
data <- cbind(data, matches)
c <- data %>%
filter(row_number() <= 100) %>%
group_by(neighborhood) %>%
count()
map_data <- geo_join(nyc_neighborhoods, c, 'neighborhood', 'neighborhood')
pal <- colorNumeric(palette='RdBu', domain=range(map_data@data$n, na.rm=T))
map_data %>%
leaflet() %>%
addTiles() %>%
addPolygons(fillColor= ~pal(n), opacity=0.1, weight=1) %>%
addProviderTiles("CartoDB.Positron")
data <- read_csv('high_ratio.csv')
points_spdf <- data
coordinates(points_spdf) <- ~lon + lat
proj4string(points_spdf) <- proj4string(nyc_neighborhoods)
matches <- over(points_spdf, nyc_neighborhoods)
data <- cbind(data, matches)
c <- data %>%
filter(row_number() <= 100) %>%
group_by(neighborhood) %>%
count()
map_data <- geo_join(nyc_neighborhoods, c, 'neighborhood', 'neighborhood')
pal <- colorNumeric(palette='RdBu', domain=range(map_data@data$n, na.rm=T))
map_data %>%
leaflet() %>%
addTiles() %>%
addPolygons(fillColor= ~pal(n), opacity=0.1, weight=1) %>%
addProviderTiles("CartoDB.Positron")
data <- read_csv('low_ratio.csv')
points_spdf <- data
coordinates(points_spdf) <- ~lon + lat
proj4string(points_spdf) <- proj4string(nyc_neighborhoods)
matches <- over(points_spdf, nyc_neighborhoods)
data <- cbind(data, matches)
c <- data %>%
filter(row_number() <= 100) %>%
group_by(neighborhood) %>%
count()
map_data <- geo_join(nyc_neighborhoods, c, 'neighborhood', 'neighborhood')
pal <- colorNumeric(palette='RdBu', domain=range(map_data@data$n, na.rm=T))
map_data %>%
leaflet() %>%
addTiles() %>%
addPolygons(fillColor= ~pal(n), opacity=0.1, weight=1) %>%
addProviderTiles("CartoDB.Positron")
map_data %>%
leaflet() %>%
addTiles() %>%
addPolygons(fillColor= ~pal(n), opacity=0.1, weight=1) %>%
addMarkers(~lon, ~lat, data=data) %>%
addProviderTiles("CartoDB.Positron")
map_data %>%
leaflet() %>%
addTiles() %>%
addPolygons(fillColor= ~pal(n), opacity=0.1, weight=1) %>%
addMarkers(~lon, ~lat, data=data %>% filter(row_number() <= 20)) %>%
addProviderTiles("CartoDB.Positron")
key
source('D:/GradClasses/Spring19/698/citibike-dashboard/graph/map.R', echo=TRUE)
source('D:/GradClasses/Spring19/698/citibike-dashboard/graph/map.R', echo=TRUE)
areas.plot('page.csv')
create.markers <- function(data, threshold=20){
markers <- data %>%
filter(row_number() <= threshold)
return(markers)
}
areas.plot <- function(file){
raw <- read_csv(file)
data <- match.neighborhoods(raw)
color <- color.creator(data)
markers <- create.markers(data)
map_data <- geo_join(nyc_neighborhoods, color, 'neighborhood', 'neighborhood')
palette <- colorNumeric(palette='RdBu', domain=range(map_data@data$n, na.rm=T))
map_data %>%
leaflet() %>%
addTiles() %>%
addPolygons(fillColor= ~palette(n), opacity=0.1, weight=1) %>%
addMarkers(~lon, ~lat, data=markers) %>%
addProviderTiles("CartoDB.Positron")
}
areas.plot <- function(file){
raw <- read_csv(file)
data <- match.neighborhoods(raw)
color <- color.creator(data)
markers <- create.markers(data)
map_data <- geo_join(nyc_neighborhoods, color, 'neighborhood', 'neighborhood')
palette <- colorNumeric(palette='RdBu', domain=range(map_data@data$n, na.rm=T))
map_data %>%
leaflet() %>%
addTiles() %>%
addPolygons(fillColor= ~palette(n), opacity=0.1, weight=1) %>%
addMarkers(~lon, ~lat, data=markers) %>%
addProviderTiles("CartoDB.Positron")
}
areas.plot('page.csv')
color.creator <- function(data, threshold=100){
color <- data %>%
filter(row_number() <= threshold) %>%
group_by(neighborhood) %>%
summarize(n = mean(pagerank))
return(color)
}
areas.plot('page.csv')
color.creator <- function(data, threshold=50){
color <- data %>%
filter(row_number() <= threshold) %>%
group_by(neighborhood) %>%
count()
return(color)
}
areas.plot('page.csv')
raw <- read_csv('page.csv')
data <- match.neighborhoods(raw)
color <- color.creator(data)
markers <- create.markers(data)
map_data <- geo_join(nyc_neighborhoods, color, 'neighborhood', 'neighborhood')
View(map_data)
create.markers <- function(data, threshold=10){
markers <- data %>%
filter(row_number() <= threshold)
return(markers)
}
areas.plot('page.csv')
create.markers <- function(data, threshold=15){
markers <- data %>%
filter(row_number() <= threshold)
return(markers)
}
areas.plot('page.csv')
areas.plot <- function(file){
data <- match.neighborhoods(file)
color <- color.creator(data)
markers <- create.markers(data)
map_data <- geo_join(nyc_neighborhoods, color, 'neighborhood', 'neighborhood')
palette <- colorNumeric(palette='RdBu', domain=range(map_data@data$n, na.rm=T))
map_data %>%
leaflet() %>%
addTiles() %>%
addPolygons(fillColor= ~palette(n), opacity=0.1, weight=1) %>%
addMarkers(~lon, ~lat, data=markers) %>%
addProviderTiles("CartoDB.Positron")
}
file <- read_csv('high_ratio.csv')
areas.plot(file)
color.creator <- function(data, threshold=100){
color <- data %>%
filter(row_number() <= threshold) %>%
group_by(neighborhood) %>%
count()
return(color)
}
areas.plot(file)
color.creator <- function(data, threshold=75){
color <- data %>%
filter(row_number() <= threshold) %>%
group_by(neighborhood) %>%
count()
return(color)
}
areas.plot(file)
file <- read_csv('high_ratio.csv') %>%
order_by(ratio, ascending=FALSE)
View(file)
file <- read_csv('high_ratio.csv')
View(file)
View(file)
file <- read_csv('high_ratio.csv') %>%
order_by(ratio)
View(file)
file <- read_csv('high_ratio.csv') %>%
order_by(ratio)
View(file)
file <- read_csv('high_ratio.csv')
file <- file %>%
order_by(ratio)
file <- file %>%
order_by('ratio')
file <- file %>%
arrange('ratio')
file <- file %>%
arrange(ratio)
View(file)
file <- read_csv('high_ratio.csv') %>%
arrange(ratio)
areas.plot(file)
areas.plot <- function(file){
data <- match.neighborhoods(file)
color <- color.creator(data)
markers <- create.markers(data)
map_data <- geo_join(nyc_neighborhoods, color, 'neighborhood', 'neighborhood')
palette <- colorNumeric(palette='BuRd', domain=range(map_data@data$n, na.rm=T))
map_data %>%
leaflet() %>%
addTiles() %>%
addPolygons(fillColor= ~palette(n), opacity=0.1, weight=1) %>%
addMarkers(~lon, ~lat, data=markers) %>%
addProviderTiles("CartoDB.Positron")
}
file <- read_csv('high_ratio.csv') %>%
arrange(ratio)
areas.plot(file)
areas.plot <- function(file){
data <- match.neighborhoods(file)
color <- color.creator(data)
markers <- create.markers(data)
map_data <- geo_join(nyc_neighborhoods, color, 'neighborhood', 'neighborhood')
palette <- colorNumeric(palette='RdBu', domain=range(map_data@data$n, na.rm=T))
map_data %>%
leaflet() %>%
addTiles() %>%
addPolygons(fillColor= ~palette(n), opacity=0.1, weight=1) %>%
addMarkers(~lon, ~lat, data=markers) %>%
addProviderTiles("CartoDB.Positron")
}
file <- read_csv('high_ratio.csv') %>%
arrange(ratio)
areas.plot(file)
